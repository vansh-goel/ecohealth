{"ast":null,"code":"'use strict';\n\nrequire('./patch-core');\nconst inherits = require('util').inherits;\nconst promisify = require('es6-promisify');\nconst EventEmitter = require('events').EventEmitter;\nmodule.exports = Agent;\nfunction isAgent(v) {\n  return v && typeof v.addRequest === 'function';\n}\n\n/**\n * Base `http.Agent` implementation.\n * No pooling/keep-alive is implemented by default.\n *\n * @param {Function} callback\n * @api public\n */\nfunction Agent(callback, _opts) {\n  if (!(this instanceof Agent)) {\n    return new Agent(callback, _opts);\n  }\n  EventEmitter.call(this);\n\n  // The callback gets promisified if it has 3 parameters\n  // (i.e. it has a callback function) lazily\n  this._promisifiedCallback = false;\n  let opts = _opts;\n  if ('function' === typeof callback) {\n    this.callback = callback;\n  } else if (callback) {\n    opts = callback;\n  }\n\n  // timeout for the socket to be returned from the callback\n  this.timeout = opts && opts.timeout || null;\n  this.options = opts;\n}\ninherits(Agent, EventEmitter);\n\n/**\n * Override this function in your subclass!\n */\nAgent.prototype.callback = function callback(req, opts) {\n  throw new Error('\"agent-base\" has no default implementation, you must subclass and override `callback()`');\n};\n\n/**\n * Called by node-core's \"_http_client.js\" module when creating\n * a new HTTP request with this Agent instance.\n *\n * @api public\n */\nAgent.prototype.addRequest = function addRequest(req, _opts) {\n  const ownOpts = Object.assign({}, _opts);\n\n  // Set default `host` for HTTP to localhost\n  if (null == ownOpts.host) {\n    ownOpts.host = 'localhost';\n  }\n\n  // Set default `port` for HTTP if none was explicitly specified\n  if (null == ownOpts.port) {\n    ownOpts.port = ownOpts.secureEndpoint ? 443 : 80;\n  }\n  const opts = Object.assign({}, this.options, ownOpts);\n  if (opts.host && opts.path) {\n    // If both a `host` and `path` are specified then it's most likely the\n    // result of a `url.parse()` call... we need to remove the `path` portion so\n    // that `net.connect()` doesn't attempt to open that as a unix socket file.\n    delete opts.path;\n  }\n  delete opts.agent;\n  delete opts.hostname;\n  delete opts._defaultAgent;\n  delete opts.defaultPort;\n  delete opts.createConnection;\n\n  // Hint to use \"Connection: close\"\n  // XXX: non-documented `http` module API :(\n  req._last = true;\n  req.shouldKeepAlive = false;\n\n  // Create the `stream.Duplex` instance\n  let timeout;\n  let timedOut = false;\n  const timeoutMs = this.timeout;\n  const freeSocket = this.freeSocket;\n  function onerror(err) {\n    if (req._hadError) return;\n    req.emit('error', err);\n    // For Safety. Some additional errors might fire later on\n    // and we need to make sure we don't double-fire the error event.\n    req._hadError = true;\n  }\n  function ontimeout() {\n    timeout = null;\n    timedOut = true;\n    const err = new Error('A \"socket\" was not created for HTTP request before ' + timeoutMs + 'ms');\n    err.code = 'ETIMEOUT';\n    onerror(err);\n  }\n  function callbackError(err) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    onerror(err);\n  }\n  function onsocket(socket) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    if (isAgent(socket)) {\n      // `socket` is actually an http.Agent instance, so relinquish\n      // responsibility for this `req` to the Agent from here on\n      socket.addRequest(req, opts);\n    } else if (socket) {\n      function onfree() {\n        freeSocket(socket, opts);\n      }\n      socket.on('free', onfree);\n      req.onSocket(socket);\n    } else {\n      const err = new Error('no Duplex stream was returned to agent-base for `' + req.method + ' ' + req.path + '`');\n      onerror(err);\n    }\n  }\n  if (!this._promisifiedCallback && this.callback.length >= 3) {\n    // Legacy callback function - convert to a Promise\n    this.callback = promisify(this.callback, this);\n    this._promisifiedCallback = true;\n  }\n  if (timeoutMs > 0) {\n    timeout = setTimeout(ontimeout, timeoutMs);\n  }\n  try {\n    Promise.resolve(this.callback(req, opts)).then(onsocket, callbackError);\n  } catch (err) {\n    Promise.reject(err).catch(callbackError);\n  }\n};\nAgent.prototype.freeSocket = function freeSocket(socket, opts) {\n  // TODO reuse sockets\n  socket.destroy();\n};","map":{"version":3,"names":["require","inherits","promisify","EventEmitter","module","exports","Agent","isAgent","v","addRequest","callback","_opts","call","_promisifiedCallback","opts","timeout","options","prototype","req","Error","ownOpts","Object","assign","host","port","secureEndpoint","path","agent","hostname","_defaultAgent","defaultPort","createConnection","_last","shouldKeepAlive","timedOut","timeoutMs","freeSocket","onerror","err","_hadError","emit","ontimeout","code","callbackError","clearTimeout","onsocket","socket","onfree","on","onSocket","method","length","setTimeout","Promise","resolve","then","reject","catch","destroy"],"sources":["/home/vanshgoel/Downloads/ecohealth-react/node_modules/.pnpm/agent-base@4.3.0/node_modules/agent-base/index.js"],"sourcesContent":["'use strict';\nrequire('./patch-core');\nconst inherits = require('util').inherits;\nconst promisify = require('es6-promisify');\nconst EventEmitter = require('events').EventEmitter;\n\nmodule.exports = Agent;\n\nfunction isAgent(v) {\n  return v && typeof v.addRequest === 'function';\n}\n\n/**\n * Base `http.Agent` implementation.\n * No pooling/keep-alive is implemented by default.\n *\n * @param {Function} callback\n * @api public\n */\nfunction Agent(callback, _opts) {\n  if (!(this instanceof Agent)) {\n    return new Agent(callback, _opts);\n  }\n\n  EventEmitter.call(this);\n\n  // The callback gets promisified if it has 3 parameters\n  // (i.e. it has a callback function) lazily\n  this._promisifiedCallback = false;\n\n  let opts = _opts;\n  if ('function' === typeof callback) {\n    this.callback = callback;\n  } else if (callback) {\n    opts = callback;\n  }\n\n  // timeout for the socket to be returned from the callback\n  this.timeout = (opts && opts.timeout) || null;\n\n  this.options = opts;\n}\ninherits(Agent, EventEmitter);\n\n/**\n * Override this function in your subclass!\n */\nAgent.prototype.callback = function callback(req, opts) {\n  throw new Error(\n    '\"agent-base\" has no default implementation, you must subclass and override `callback()`'\n  );\n};\n\n/**\n * Called by node-core's \"_http_client.js\" module when creating\n * a new HTTP request with this Agent instance.\n *\n * @api public\n */\nAgent.prototype.addRequest = function addRequest(req, _opts) {\n  const ownOpts = Object.assign({}, _opts);\n\n  // Set default `host` for HTTP to localhost\n  if (null == ownOpts.host) {\n    ownOpts.host = 'localhost';\n  }\n\n  // Set default `port` for HTTP if none was explicitly specified\n  if (null == ownOpts.port) {\n    ownOpts.port = ownOpts.secureEndpoint ? 443 : 80;\n  }\n\n  const opts = Object.assign({}, this.options, ownOpts);\n\n  if (opts.host && opts.path) {\n    // If both a `host` and `path` are specified then it's most likely the\n    // result of a `url.parse()` call... we need to remove the `path` portion so\n    // that `net.connect()` doesn't attempt to open that as a unix socket file.\n    delete opts.path;\n  }\n\n  delete opts.agent;\n  delete opts.hostname;\n  delete opts._defaultAgent;\n  delete opts.defaultPort;\n  delete opts.createConnection;\n\n  // Hint to use \"Connection: close\"\n  // XXX: non-documented `http` module API :(\n  req._last = true;\n  req.shouldKeepAlive = false;\n\n  // Create the `stream.Duplex` instance\n  let timeout;\n  let timedOut = false;\n  const timeoutMs = this.timeout;\n  const freeSocket = this.freeSocket;\n\n  function onerror(err) {\n    if (req._hadError) return;\n    req.emit('error', err);\n    // For Safety. Some additional errors might fire later on\n    // and we need to make sure we don't double-fire the error event.\n    req._hadError = true;\n  }\n\n  function ontimeout() {\n    timeout = null;\n    timedOut = true;\n    const err = new Error(\n      'A \"socket\" was not created for HTTP request before ' + timeoutMs + 'ms'\n    );\n    err.code = 'ETIMEOUT';\n    onerror(err);\n  }\n\n  function callbackError(err) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    onerror(err);\n  }\n\n  function onsocket(socket) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    if (isAgent(socket)) {\n      // `socket` is actually an http.Agent instance, so relinquish\n      // responsibility for this `req` to the Agent from here on\n      socket.addRequest(req, opts);\n    } else if (socket) {\n      function onfree() {\n        freeSocket(socket, opts);\n      }\n      socket.on('free', onfree);\n      req.onSocket(socket);\n    } else {\n      const err = new Error(\n        'no Duplex stream was returned to agent-base for `' + req.method + ' ' + req.path + '`'\n      );\n      onerror(err);\n    }\n  }\n\n  if (!this._promisifiedCallback && this.callback.length >= 3) {\n    // Legacy callback function - convert to a Promise\n    this.callback = promisify(this.callback, this);\n    this._promisifiedCallback = true;\n  }\n\n  if (timeoutMs > 0) {\n    timeout = setTimeout(ontimeout, timeoutMs);\n  }\n\n  try {\n    Promise.resolve(this.callback(req, opts)).then(onsocket, callbackError);\n  } catch (err) {\n    Promise.reject(err).catch(callbackError);\n  }\n};\n\nAgent.prototype.freeSocket = function freeSocket(socket, opts) {\n  // TODO reuse sockets\n  socket.destroy();\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}